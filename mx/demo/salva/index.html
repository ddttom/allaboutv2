<!DOCTYPE html>
<!--
Root redirect for Los Granainos Restaurant n-language site.
Detects browser Accept-Language preference and redirects to appropriate language directory.

N-Language Architecture:
- Supports any number of languages (es, en, fr, de, es-mx, en-gb, etc.)
- Languages are auto-discovered from directory structure
- Fallback cascade: regional → base → default
- No cookies/localStorage - always follows Accept-Language header (GDPR compliant)

When REGINALD edge is deployed, this redirect happens at Cloudflare Worker level.
This file serves as client-side fallback for sites not using REGINALD edge.
-->
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex, follow">
  <title>Los Granainos - Redirecting / Redirigiendo...</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      max-width: 600px;
      margin: 100px auto;
      padding: 20px;
      text-align: center;
      line-height: 1.6;
      background: #faf8f5;
      color: #374151;
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 2rem;
      color: #1a1a1a;
    }
    ul {
      list-style: none;
      padding: 0;
      margin: 2rem 0;
    }
    li {
      margin: 1rem 0;
    }
    a {
      display: inline-block;
      padding: 12px 24px;
      background: #e8997e;
      color: white;
      text-decoration: none;
      border-radius: 50px;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    a:hover {
      background: #d88265;
      transform: translateY(-2px);
    }
    .loading {
      color: #666;
      font-size: 0.9rem;
    }
  </style>
  <script>
    (function() {
      /**
       * N-Language Redirect System
       *
       * Supports unlimited languages with Accept-Language header detection.
       * Regional variant cascade: es-MX → es → default
       */

      // Available languages (configured per site)
      // In production, this could be dynamically generated at build time
      const availableLanguages = ['es', 'en'];

      // Default language (primary business language)
      const defaultLanguage = 'es';

      /**
       * Parse browser language preferences
       * Returns array of language codes sorted by quality preference
       */
      function getBrowserLanguages() {
        const languages = navigator.languages || [navigator.language || navigator.userLanguage];
        return languages.map(lang => ({
          full: lang.toLowerCase(),
          base: lang.toLowerCase().split('-')[0]
        }));
      }

      /**
       * Find best matching language
       * Implements cascading fallback: regional → base → default
       */
      function findBestLanguage(browserLangs, available, defaultLang) {
        for (const pref of browserLangs) {
          // Try exact regional match first (es-mx)
          if (available.includes(pref.full)) {
            return pref.full;
          }
          // Try base language match (es)
          if (available.includes(pref.base)) {
            return pref.base;
          }
        }
        // Fallback to default
        return defaultLang;
      }

      // Detect and redirect
      const browserLangs = getBrowserLanguages();
      const targetLang = findBestLanguage(browserLangs, availableLanguages, defaultLanguage);

      // Redirect to appropriate language directory
      window.location.href = targetLang + '/index.html';
    })();
  </script>
</head>
<body>
  <!-- Fallback content for users with JavaScript disabled -->
  <noscript>
    <h1>Choose Your Language / Elige tu idioma</h1>
    <p>Please select your preferred language:</p>
    <p>Por favor selecciona tu idioma preferido:</p>
    <ul>
      <li><a href="es/index.html">Español</a></li>
      <li><a href="en/index.html">English</a></li>
    </ul>
  </noscript>

  <!-- Loading message (visible briefly before redirect) -->
  <p class="loading">Redirecting / Redirigiendo...</p>
</body>
</html>
